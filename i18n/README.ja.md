[English](../README.md) Â· [Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©](README.ar.md) Â· [EspaÃ±ol](README.es.md) Â· [FranÃ§ais](README.fr.md) Â· [æ—¥æœ¬èª](README.ja.md) Â· [í•œêµ­ì–´](README.ko.md) Â· [Tiáº¿ng Viá»‡t](README.vi.md) Â· [ä¸­æ–‡ (ç®€ä½“)](README.zh-Hans.md) Â· [ä¸­æ–‡ï¼ˆç¹é«”ï¼‰](README.zh-Hant.md) Â· [Deutsch](README.de.md) Â· [Ğ ÑƒÑÑĞºĞ¸Ğ¹](README.ru.md)


<p align="center">
  <img src="https://raw.githubusercontent.com/lachlanchen/lachlanchen/main/logos/banner.png" alt="LazyingArt banner" />
</p>

# MetaTrader QT - ã‚¯ã‚ªãƒ³ãƒ„å–å¼•ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ï¼ˆMicro Quant Philosophyï¼‰

![Python](https://img.shields.io/badge/Python-3.10%2B-3776AB?logo=python&logoColor=white)
![Backend](https://img.shields.io/badge/Backend-Tornado-2d7cbf)
![Database](https://img.shields.io/badge/Database-PostgreSQL-336791?logo=postgresql&logoColor=white)
![Broker](https://img.shields.io/badge/Broker%20Bridge-MetaTrader5-1f6feb)
![UI](https://img.shields.io/badge/UI-Lightweight%20Charts%20%2B%20Chart.js-0ea5e9)
![Status](https://img.shields.io/badge/README-Expanded-success)

## ğŸ“¸ ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
![Micro Quant UI](figures/demos/micro-quant-ui.png)

<p align="center">
  <a href="https://my.roboforex.com/en/?a=efx" target="_blank" rel="noopener noreferrer">
    <button style="padding: 0.65rem 1.25rem; font-weight: 600; border-radius: 999px; border: none; color: white; background: #0060ff; cursor: pointer;">
      DATA Source
    </button>
  </a>
</p>

## ğŸ§­ æ¦‚è¦
Micro Quant ã¯æ´¾æ‰‹ãªãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚ˆã‚Šã‚‚ã€å†ç¾å¯èƒ½ãªå–å¼•ãƒ­ã‚¸ãƒƒã‚¯ã®ç©ã¿ä¸Šã’ã‚’é‡è¦–ã—ã¾ã™ã€‚MetaTrader 5 ã‹ã‚‰ OHLC ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€Postgres ã«æ°¸ç¶šåŒ–ã—ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼åŒ–ã•ã‚ŒãŸ AI ã‚¬ã‚¤ãƒ‰ä¿¡å·ï¼ˆBasic newsã€Tech snapshotã€trade plansã€STL overlaysï¼‰ã§ä½“ç³»çš„ãªæ„æ€æ±ºå®šã‚’è©•ä¾¡ã—ã¾ã™ã€‚UI ã‚‚ã“ã®æ€æƒ³ã«æ²¿ã£ã¦ãŠã‚Šã€ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆåˆ‡ã‚Šæ›¿ãˆã€ç†ç”±ä»˜ãã‚¯ãƒ­ãƒ¼ã‚ºã€è¨­å®šã®æ°¸ç¶šåŒ–ã€æƒ…å ±é‡ã®å¤šã„åŸ·è¡Œãƒšã‚¤ãƒ³ã‚’å‚™ãˆã€ãƒ­ã‚°ã¨æ ¹æ‹ ã‚’ç¢ºèªã—ãªãŒã‚‰ã‚µãƒ¼ãƒãƒ¼å´ã§å®šæœŸå®Ÿè¡Œãƒ»ãƒ¢ãƒ¼ãƒ€ãƒ«å®Ÿè¡Œã®ãƒ•ãƒ­ãƒ¼ã‚’å®‰å…¨ã«å›ã›ã¾ã™ã€‚

é™çš„ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸ï¼ˆQuant by Lazying.artï¼‰ã¯ `docs/` é…ä¸‹ã«ã‚ã‚Šã€GitHub Pagesï¼ˆ`docs/CNAME` çµŒç”±ã® `trade.lazying.art`ï¼‰ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚ãƒªãƒã‚¸ãƒˆãƒªã«ã¯ AI Trade Plan ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã€é€£æºãƒ¡ãƒ¢ã€é‹ç”¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚‚å«ã¾ã‚Œã¾ã™ã€‚

### ã²ã¨ç›®ã§åˆ†ã‹ã‚‹æ§‹æˆ
| Area | What it does |
|---|---|
| Data | MT5 ã® OHLC ã‚’å–å¾—ã—ã¦ PostgreSQL ã« upsert |
| Analytics | health/news/tech ã¨ STL ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œ |
| Decisioning | å¤šå±¤ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ AI trade plan ã‚’ç”Ÿæˆ |
| Execution | å®‰å…¨ã‚¬ãƒ¼ãƒ‰ã®èƒŒå¾Œã§å–å¼•ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œãƒ»åˆ¶å¾¡ |
| UI | ãƒãƒ£ãƒ¼ãƒˆåŒæœŸãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä»˜ãã®ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—/ãƒ¢ãƒã‚¤ãƒ«ç”»é¢ |

## ğŸ§  ã‚³ã‚¢å“²å­¦
- **Chain of truth**: Basic news checksï¼ˆãƒ†ã‚­ã‚¹ãƒˆ + ã‚¹ã‚³ã‚¢ï¼‰ã¨ Tech snapshotsï¼ˆé‡ã„ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æ–‡è„ˆ + STLï¼‰ã‚’ã€éŠ˜æŸ„/æ™‚é–“è¶³ã”ã¨ã®å˜ä¸€ AI trade plan ã«é›†ç´„ã—ã¾ã™ã€‚å®šæœŸ auto-run ã¨æ‰‹å‹• modal run ã¯åŒã˜ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¨ reasoning logs ã‚’å…±æœ‰ã—ã¾ã™ã€‚
- **Alignment-first execution**: Accept-Tech/Hold-Neutral ãƒˆã‚°ãƒ«ã€ignore-basics ã‚¹ã‚¤ãƒƒãƒã€partial-close ãƒ©ãƒƒãƒ‘ãƒ¼ã«ã‚ˆã£ã¦ã€Tech ã‚’æ„å›³çš„ã«è¿½å¾“ã—ã€å¿…è¦æ™‚ã¯æ–°è¦ã‚¨ãƒ³ãƒˆãƒªãƒ¼å‰ã«åå¯¾ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚’ã‚¯ãƒ­ãƒ¼ã‚ºã—ã€ä¸è¦ãªæ‰‹ä»•èˆã„ã‚’æœ€å°åŒ–ã—ã¾ã™ã€‚
- **Immutable data**: ã™ã¹ã¦ã® fetch ã¯ `ON CONFLICT` é‹ç”¨ã§ Postgres ã«æ›¸ãè¾¼ã¿ã€`/api/data` ã¯ UI å‘ã‘ã«ã‚µãƒ‹ã‚¿ã‚¤ã‚ºæ¸ˆã¿ç³»åˆ—ã‚’èª­ã¿å‡ºã—ã¾ã™ã€‚è¨­å®šï¼ˆauto volumeã€`close_fraction`ã€hide-tech ãƒˆã‚°ãƒ«ã€STL auto-computeï¼‰ã¯ `/api/preferences` ã§æ°¸ç¶šåŒ–ã•ã‚Œã¾ã™ã€‚
- **Safety-first trading**: `TRADING_ENABLED` ã¨ `safe_max` ãŒæ‰‹å‹•/è‡ªå‹•ã®è¨±å¯ç¯„å›²ã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚`/api/close` ã¨ periodic runner ã¯ã‚¯ãƒ­ãƒ¼ã‚ºç†ç”±ï¼ˆtech neutralã€misalignment ãªã©ï¼‰ã‚’è¨˜éŒ²ã§ãã€è¿½è·¡å¯èƒ½æ€§ã‚’ç¢ºä¿ã—ã¾ã™ã€‚

## âœ¨ æ©Ÿèƒ½
- MT5 OHLC ã® Postgres å–ã‚Šè¾¼ã¿ï¼ˆ`/api/fetch`, `/api/fetch_bulk`ï¼‰ã€‚
- `/`ï¼ˆãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ï¼‰ã¨ `/app`ï¼ˆãƒ¢ãƒã‚¤ãƒ«ï¼‰ã®ãƒãƒ£ãƒ¼ãƒˆ UIã€‚ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ Chart.js + Lightweight Charts ã‚’ä½¿ç”¨ã€‚
- STL åˆ†è§£ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆ`/api/stl`, `/api/stl/compute`, prune/delete ç³»ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰ã€‚
- ãƒ‹ãƒ¥ãƒ¼ã‚¹å–å¾—ã¨åˆ†æï¼ˆ`/api/news`, `/api/news/backfill_forex`, `/api/news/analyze`ï¼‰ã€‚
- AI ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼çµ±åˆï¼ˆ`/api/health/run`, `/api/health/runs`, `/api/ai/trade_plan`ï¼‰ã€‚
- æ‰‹å‹•å–å¼•å®Ÿè¡Œï¼ˆ`/api/trade`, `/api/trade/execute_plan`ï¼‰ã€‚`TRADING_ENABLED` ã§ä¿è­·ã€‚
- ãƒã‚¸ã‚·ãƒ§ãƒ³ãƒªã‚¹ã‚¯æ“ä½œï¼ˆ`/api/positions*`, `/api/close`, `/api/close_tickets`ï¼‰ã€‚å®‰å…¨æ€§ã®ãŸã‚ close æ“ä½œã¯è¨±å¯ã€‚
- `/ws/updates` ã§ WebSocket æ›´æ–°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’é…ä¿¡ã€‚

## ğŸ—‚ï¸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ
```text
metatrader_qt/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ server.py                # Tornado app, routes, orchestration
â”‚   â”œâ”€â”€ db.py                    # asyncpg access layer + schema init
â”‚   â”œâ”€â”€ mt5_client.py            # MetaTrader5 bridge + order/data operations
â”‚   â”œâ”€â”€ news_fetcher.py          # FMP/AlphaVantage aggregation/filtering
â”‚   â””â”€â”€ strategy.py              # SMA crossover helper
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ index.html               # Main desktop UI
â”‚   â””â”€â”€ mobile.html              # Mobile-oriented UI
â”œâ”€â”€ static/                      # PWA assets (icons/manifest/service worker)
â”œâ”€â”€ sql/
â”‚   â””â”€â”€ schema.sql               # Core DB schema
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ test_mixed_ai.py         # Mixed AI smoke test
â”‚   â”œâ”€â”€ test_fmp.py              # FMP smoke test
â”‚   â”œâ”€â”€ test_fmp_endpoints.py    # FMP endpoint probe script
â”‚   â”œâ”€â”€ setup_windows.ps1        # Windows env bootstrap
â”‚   â”œâ”€â”€ run_windows.ps1          # Windows run helper
â”‚   â””â”€â”€ bootstrap_venv311.sh     # Linux/mac Python 3.11 helper
â”œâ”€â”€ docs/                        # GitHub Pages landing site
â”œâ”€â”€ references/                  # Operational/setup notes
â”œâ”€â”€ strategies/llm/              # Prompt/config JSON files
â”œâ”€â”€ llm_model/echomind/          # LLM provider wrappers
â”œâ”€â”€ i18n/                        # Present (currently empty)
â”œâ”€â”€ .github/FUNDING.yml          # Sponsor/support metadata
â””â”€â”€ README.md + README.*.md      # Canonical + multilingual docs
```

## âœ… å‰ææ¡ä»¶
- Ubuntu/Linux ã¾ãŸã¯ Windowsã€‚
- MT5 ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ï¼ˆ`terminal64.exe`ï¼‰ã€ã‹ã¤ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ãŒèµ·å‹•ãƒ»ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã€‚
- Python 3.10+ï¼ˆMetaTrader5 äº’æ›æ€§ã®è¦³ç‚¹ã§ 3.11 æ¨å¥¨ï¼‰ã€‚
- PostgreSQL ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã€‚

## ğŸ› ï¸ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### Windows (PowerShell)
```powershell
# 1) Create venv with Python 3.11 (MetaTrader5 has no wheels for 3.13 yet)
py -3.11 -m venv .venv
.\.venv\Scripts\Activate.ps1
pip install --upgrade pip
pip install -r requirements.txt

# 2) Configure env
Copy-Item .env.example .env
# Edit .env and set DATABASE_URL, MT5_PATH (e.g. C:\Program Files\MetaTrader 5\terminal64.exe), and your MT5 demo creds
# Load env for this session
Get-Content .env | Where-Object { $_ -and $_ -notmatch '^#' } | ForEach-Object { $n,$v = $_ -split '=',2; [Environment]::SetEnvironmentVariable($n, $v, 'Process') }

# 3) Run app
python -m app.server
# Open http://localhost:8888
```

è£œåŠ©ã‚¹ã‚¯ãƒªãƒ—ãƒˆ:
```powershell
scripts\setup_windows.ps1
scripts\run_windows.ps1
```

### Linux/macOS (bash)
```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt

# Alternative: local 3.11 venv (if your global/Conda Python is 3.13)
# Requires python3.11 on your system
# sudo apt install python3.11 python3.11-venv
bash scripts/bootstrap_venv311.sh
source .venv311/bin/activate

# DB (use your own user/password as needed)
# createdb -h localhost -p 5432 -U lachlan metatrader_db

# Configure env
cp .env.example .env
# edit .env with your MT5 path and credentials
set -a; source .env; set +a

# Run app
python -m app.server
# Open http://localhost:8888
```

## âš™ï¸ è¨­å®š
`.env.example` ã‚’ `.env` ã«ã‚³ãƒ”ãƒ¼ã—ã€å€¤ã‚’èª¿æ•´ã—ã¦ãã ã•ã„ã€‚

### ã‚³ã‚¢å¤‰æ•°
| Variable | Purpose |
|---|---|
| `DATABASE_URL` | å„ªå…ˆã•ã‚Œã‚‹ PostgreSQL DSN |
| `DATABASE_MT_URL` | `DATABASE_URL` æœªè¨­å®šæ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ DSN |
| `DATABASE_QT_URL` | ç¬¬2ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ DSN |
| `MT5_PATH` | `terminal64.exe` ã®ãƒ‘ã‚¹ï¼ˆWine ã¾ãŸã¯ãƒã‚¤ãƒ†ã‚£ãƒ–ï¼‰ |
| `MT5_LOGIN` / `MT5_PASSWORD` / `MT5_SERVER` | MT5 ç«¯æœ«ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒæ—¢ã«ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ãªã‚‰ä»»æ„ |
| `PORT` | ã‚µãƒ¼ãƒãƒ¼ãƒãƒ¼ãƒˆï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ `8888`ï¼‰ |

### ä»»æ„å¤‰æ•°
- ãƒ‹ãƒ¥ãƒ¼ã‚¹æ‹¡å¼µç”¨ `FMP_API_KEY`, `ALPHAVANTAGE_API_KEY`ã€‚
- `TRADING_ENABLED`ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ `0`ã€‚æ³¨æ–‡ç³»ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¨±å¯ã™ã‚‹ã«ã¯ `1`ï¼‰ã€‚
- `TRADING_VOLUME`ï¼ˆæ‰‹å‹•å–å¼•ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæ•°é‡ï¼‰ã€‚
- `AUTO_FETCH`, `AUTO_FETCH_SYMBOL`, `AUTO_FETCH_TF`, `AUTO_FETCH_COUNT`, `AUTO_FETCH_SEC`ã€‚
- `PIN_DEFAULTS_TO_XAU_H1=1` ã§ UI èµ·å‹•æ™‚ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆéŠ˜æŸ„/æ™‚é–“è¶³ã‚’å›ºå®šã€‚
- `LOG_LEVEL`, `LOG_BACKFILL`ã€ãŠã‚ˆã³ `/api/preferences` ã¨ç’°å¢ƒå¤‰æ•°çµŒç”±ã® account/poll é–¢é€£è¨­å®šã€‚

æ³¨è¨˜:
- `MT5_PATH` ã¯ã€MT5 ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ä½¿ã† Wine prefix å†…ã® `terminal64.exe` ã‚’æŒ‡ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
- ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒæ—¢ã«ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ãªã‚‰ MT5 èªè¨¼æƒ…å ±ã¯çœç•¥å¯èƒ½ã§ã€ã‚¢ãƒ—ãƒªã¯ãã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å†åˆ©ç”¨ã‚’è©¦ã¿ã¾ã™ã€‚

## ğŸš€ ä½¿ã„æ–¹

### ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
```bash
python -m app.server
```

### UI ã‚’é–‹ã
- ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ— UI: `http://localhost:8888/`
- ãƒ¢ãƒã‚¤ãƒ« UI: `http://localhost:8888/app`

### ä¸€èˆ¬çš„ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
1. MT5 ã‹ã‚‰ãƒãƒ¼ã‚’å–å¾—ã—ã¦ Postgres ã«ä¿å­˜ã€‚
2. ãƒãƒ£ãƒ¼ãƒˆè¡¨ç¤ºã®ãŸã‚ DB ã‹ã‚‰ãƒãƒ¼ã‚’èª­ã¿è¾¼ã¿ã€‚
3. health/tech/news åˆ†æã‚’å®Ÿè¡Œã€‚
4. AI trade plan ã‚’ç”Ÿæˆã€‚
5. å®‰å…¨ã‚¬ãƒ¼ãƒ‰ä¸‹ã§ãƒã‚¸ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œã¾ãŸã¯ã‚¯ãƒ­ãƒ¼ã‚ºã€‚

## ğŸ”Œ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆå®Ÿè·µï¼‰
- `GET /api/fetch?symbol=XAUUSD&tf=H1&count=500[&mode=inc|full][&persist=1]`
  - MT5 ã‹ã‚‰å–å¾—ã—ã¦ DB ã« upsertã€‚
  - `persist=1` ã®å ´åˆã€ã‚µãƒ¼ãƒãƒ¼ã¯ `last_symbol/last_tf/last_count` ã‚’ä¿å­˜ã—ã¾ã™ã€‚bulk/background fetch ã§ã¯ UI é¸æŠã‚’ä¸Šæ›¸ãã—ãªã„ã‚ˆã†çœç•¥ã—ã¦ãã ã•ã„ã€‚
- `GET /api/fetch_bulk` â€” ä¸€æ‹¬/å®šæœŸå–ã‚Šè¾¼ã¿ã€‚
- `GET /api/data?symbol=XAUUSD&tf=H1&limit=500` â€” DB ã‹ã‚‰ãƒãƒ£ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã€‚
- `GET /api/strategy/run?symbol=XAUUSD&tf=H1&fast=20&slow=50`
  - SMA(20/50) ã‚¯ãƒ­ã‚¹ã‚ªãƒ¼ãƒãƒ¼ã‚’å®Ÿè¡Œã—ã€ã‚·ã‚°ãƒŠãƒ« payload ã‚’è¿”ã—ã¾ã™ã€‚
  - é‡è¦å®Ÿè£…ãƒ¡ãƒ¢: ã“ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‹ã‚‰ã® strategy é§†å‹•æ³¨æ–‡ã¯ç¾åœ¨ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ã§ç„¡åŠ¹åŒ–ã•ã‚Œã¦ãŠã‚Šã€æ³¨æ–‡å®Ÿè¡Œã¯ trade ç³»ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§å‡¦ç†ã•ã‚Œã¾ã™ã€‚
- `POST /api/trade` â€” UI ã‹ã‚‰ã®æ‰‹å‹• Buy/Sellã€‚`TRADING_ENABLED` ã§ã‚²ãƒ¼ãƒˆã€‚
- `POST /api/trade/execute_plan` â€” ç”Ÿæˆæ¸ˆã¿ plan ã‚’å®Ÿè¡Œã€‚äº‹å‰ã‚¯ãƒ­ãƒ¼ã‚ºã¨ stop-distance ãƒã‚§ãƒƒã‚¯ã‚’å«ã¿ã¾ã™ã€‚
- `POST /api/close` â€” ãƒã‚¸ã‚·ãƒ§ãƒ³å…¨æ±ºæ¸ˆï¼ˆå®‰å…¨æ€§ã®ãŸã‚ `TRADING_ENABLED=0` ã§ã‚‚è¨±å¯ï¼‰:
  - ç¾åœ¨éŠ˜æŸ„: form body `symbol=...`; ä»»æ„ã§ `side=long|short|both`ã€‚
  - å…¨éŠ˜æŸ„: `?scope=all` ã¨ä»»æ„ã® `&side=...`ã€‚
  - ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ã¯ `closed_count` ã¨ãƒã‚±ãƒƒãƒˆã”ã¨ã®çµæœãŒå«ã¾ã‚Œã¾ã™ã€‚
- `POST /api/close_tickets` â€” æŒ‡å®šã—ãŸãƒã‚±ãƒƒãƒˆé›†åˆã®ã¿ã‚¯ãƒ­ãƒ¼ã‚ºã€‚
- `GET /api/positions`, `GET /api/positions/all`ã€‚
- `GET /api/stl`, `POST /api/stl/compute`, `POST /api/stl/prune`, `POST /api/stl/prune_all`, `DELETE /api/stl/run/{id}`ã€‚
- `GET /api/news`, `POST /api/news/backfill_forex`, `POST /api/news/analyze`ã€‚
- `GET /api/health/freshness`, `GET /api/tech/freshness`, `GET|POST /api/health/run`, `GET /api/health/runs`ã€‚
- `POST /api/preferences` ã¨é–¢é€£ã®è¨­å®šå–å¾—ã€‚
- `GET /api/ai/trade_plan`ã€‚
- `GET /api/accounts`, `GET /api/account/current`, `POST /api/account/login`ã€‚
- `GET /ws/updates`ã€‚

## ğŸ§ª ä¾‹
```bash
# Fetch 500 H1 bars for XAUUSD
curl "http://localhost:8888/api/fetch?symbol=XAUUSD&tf=H1&count=500"

# Read 200 bars from DB
curl "http://localhost:8888/api/data?symbol=XAUUSD&tf=H1&limit=200"

# Run SMA signal calculation
curl "http://localhost:8888/api/strategy/run?symbol=XAUUSD&tf=H1&fast=20&slow=50"

# Close current symbol long positions
curl -X POST "http://localhost:8888/api/close" -d "symbol=XAUUSD&side=long"

# Close all short positions across symbols
curl -X POST "http://localhost:8888/api/close?scope=all&side=short"
```

## ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã‚¹ã‚­ãƒ¼ãƒ
`sql/schema.sql` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

è¦ç‚¹:
- `ohlc_bars` ã®è¤‡åˆ PK `(symbol, timeframe, ts)` ãŒé‡è¤‡ãƒãƒ¼ã‚’é˜²æ­¢ã€‚
- å–ã‚Šè¾¼ã¿ã¯ `ON CONFLICT ... DO UPDATE` ã‚’ä½¿ç”¨ã€‚
- è¿½åŠ ãƒ†ãƒ¼ãƒ–ãƒ«ã§ STL run/componentsã€preferencesã€news articlesã€health runsã€account seriesã€closed dealsã€signal/order-plan linking ã‚’ã‚µãƒãƒ¼ãƒˆã€‚

## ğŸ›¡ï¸ å–å¼•åˆ¶å¾¡ã¨å®‰å…¨æ€§
- ç’°å¢ƒã‚¬ãƒ¼ãƒ‰: `TRADING_ENABLED=0`ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ã§ã¯ manual/plan execution ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‹ã‚‰ã®æ³¨æ–‡ç™ºè¡Œã‚’ç„¡åŠ¹åŒ–ã€‚
- UI ã® `Auto` ãƒ˜ãƒƒãƒ€ãƒ¼æŒ™å‹•ã¯ strategy ãƒã‚§ãƒƒã‚¯ã‚’ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã—ã¾ã™ãŒã€å–å¼•å®‰å…¨ã‚²ãƒ¼ãƒˆã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã¾ã›ã‚“ã€‚
- close æ“ä½œã¯ã€å–å¼•ç„¡åŠ¹æ™‚ã§ã‚‚æ„å›³çš„ã«è¨±å¯ã•ã‚Œã¦ã„ã¾ã™ã€‚
- safe-max ã¨ symbol/kind weighting ã«ã‚ˆã‚Šã€åŸ·è¡Œãƒ•ãƒ­ãƒ¼å†…ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ã‚¸ãƒ£ã‚’åˆ¶é™ã—ã¾ã™ã€‚

## ğŸ“ˆ STL Auto-Compute ãƒˆã‚°ãƒ«
- STL è‡ªå‹•è¨ˆç®—ã¯ STL ãƒ‘ãƒãƒ«ã® `Auto STL` ã‚¹ã‚¤ãƒƒãƒã§ã€symbol x timeframe ã”ã¨ã«åˆ¶å¾¡ã•ã‚Œã¾ã™ã€‚
- å¤§ãã„/é‡ã„æ–‡è„ˆã§ã® UI é…å»¶ã‚’æŠ‘ãˆã‚‹ãŸã‚ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ OFFã€‚
- ON ã®å ´åˆã¯æ¬ æ/å¤ã„ STL ã‚’è‡ªå‹•è¨ˆç®—ã§ãã€OFF ã®å ´åˆã¯æ‰‹å‹•å†è¨ˆç®—ã‚’ä½¿ã„ã¾ã™ã€‚
- çŠ¶æ…‹ã¯ `/api/preferences` ã® `stl_auto_compute:SYMBOL:TF` ãªã©ã®ã‚­ãƒ¼ã¨ã€èµ·å‹•é«˜é€ŸåŒ–ã®ãŸã‚ã® local storage ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

## ğŸ§· æœ€å¾Œã®é¸æŠçŠ¶æ…‹ã‚’è¨˜æ†¶
- ã‚µãƒ¼ãƒãƒ¼ã¯ `last_symbol`, `last_tf`, `last_count` ã‚’ä¿å­˜ã—ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæ³¨å…¥ã—ã¾ã™ã€‚
- UI ã‚‚ `localStorage` ã« `last_symbol`/`last_tf` ã‚’ä¿å­˜ã—ã¾ã™ã€‚
- `/?reset=1` ã‚’ä»˜ã‘ã‚‹ã¨ã€ãã®ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿ã§ã¯ä¿å­˜æ¸ˆã¿è¨­å®šã‚’ç„¡è¦–ã—ã¾ã™ã€‚
- `PIN_DEFAULTS_TO_XAU_H1=1` ã§èµ·å‹•ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚’å¼·åˆ¶ã§ãã¾ã™ã€‚

## ğŸ¤– AI Trade Plan ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ–‡è„ˆ
AI trade plan ã®è¦æ±‚æ™‚ã€ã‚µãƒ¼ãƒãƒ¼ã¯ç¾åœ¨ã® symbol/timeframe ã«å¯¾ã—ã¦æ–°ã—ã„ Basic Health ã¨ Tech Snapshot run ãŒã‚ã‚‹ã“ã¨ã‚’ä¿è¨¼ã—ï¼ˆãªã‘ã‚Œã°ä½œæˆï¼‰ã€æ¬¡ã®æ–‡è„ˆã‹ã‚‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚
- Basic health block,
- Tech AI block,
- Live technical snapshot block.

## ğŸ§° é–‹ç™ºãƒ¡ãƒ¢
- ä¸»ãªå®Ÿè¡Œæ™‚ä¾å­˜: `tornado`, `asyncpg`, `MetaTrader5`, `numpy`, `python-dotenv`, `requests`, `httpx`, `statsmodels`, `openai`ã€‚
- ç¾çŠ¶ã€æ­£å¼ãªè‡ªå‹•ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã¯æœªæ§‹æˆã€‚smoke test ã¨æ‰‹å‹• UI æ¤œè¨¼ãŒå®Ÿé‹ç”¨ãƒ•ãƒ­ãƒ¼ã§ã™ã€‚
- æ¨å¥¨ smoke tests:
  - `python scripts/test_mixed_ai.py`
  - `python scripts/test_fmp.py`
  - `python scripts/test_fmp_endpoints.py`
- push å‰ã«è¡Œã†æ‰‹å‹•ç¢ºèª:
  - pan/zoom åŒæœŸ,
  - STL overlay/period line ã®æŒ™å‹•,
  - trading controlsï¼ˆclose safety behavior ã‚’å«ã‚€ï¼‰, 
  - news panel ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æŒ™å‹•ã€‚

## ğŸ§¯ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
| Symptom | Action |
|---|---|
| MT5 initialize failed | `MT5_PATH` ã‚’æ­£ç¢ºãª `terminal64.exe` ã«è¨­å®šã—ã€ã¾ãšã¯ç«¯æœ«ã‚’æ‰‹å‹•ã§å°‘ãªãã¨ã‚‚ä¸€åº¦èµ·å‹• |
| MT5 login failed | `MT5_SERVER` ãŒç«¯æœ«ã®ã‚µãƒ¼ãƒãƒ¼æ–‡å­—åˆ—ã¨å®Œå…¨ä¸€è‡´ã™ã‚‹ã‹ç¢ºèªã€‚ã‚‚ã—ãã¯èªè¨¼æƒ…å ±ã‚’çœç•¥ã—ã¦ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å†åˆ©ç”¨ |
| No data for symbol | ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼å´ã‚·ãƒ³ãƒœãƒ«åã¨ Market Watch è¡¨ç¤ºã‚’ç¢ºèªï¼ˆ`XAUUSD`, `XAUUSD.a`, `GOLD` ãªã©ï¼‰ |
| Postgres connection issues | `DATABASE_URL` ã‚’ç¢ºèªã—ã€`psql "$DATABASE_URL" -c 'select 1;'` ã‚’å®Ÿè¡Œ |
| Slow or stale UI analytics | é‡ã„ pair/TF ã§ã¯ auto STL ã‚’ç„¡åŠ¹åŒ–ã—ã€å¿…è¦æ™‚ã«æ‰‹å‹•å†è¨ˆç®— |

## ğŸ›£ï¸ ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—
- README ãƒ™ãƒ¼ã‚¹ã®å¤šè¨€èªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¶…ãˆã¦ã€`i18n/` ã®å®Ÿè¡Œæ™‚ã‚¢ã‚»ãƒƒãƒˆã‚’æ‹¡å¼µã€‚
- æ­£å¼ãªè‡ªå‹•ãƒ†ã‚¹ãƒˆï¼ˆAPI + integration + UI smoke automationï¼‰ã‚’è¿½åŠ ã€‚
- ãƒ‡ãƒ—ãƒ­ã‚¤ç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°ã¨å†ç¾å¯èƒ½ãªç’°å¢ƒãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ”¹å–„ã€‚
- AI plan ã®æ¤œè¨¼ã¨å®Ÿè¡Œã‚»ãƒ¼ãƒ•ã‚¬ãƒ¼ãƒ‰ã‚’ç¶™ç¶šçš„ã«æ´—ç·´ã€‚

## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ãƒˆ
- ãƒ‘ãƒƒãƒã¯å°ã•ãã‚¹ã‚³ãƒ¼ãƒ—ã‚’æ˜ç¢ºã«ã€‚
- å¿…è¦ã«å¿œã˜ã¦æ˜ç¢ºãªã‚³ãƒŸãƒƒãƒˆæ¥é ­è¾ã‚’ä½¿ç”¨ï¼ˆä¾‹: `UI: ...`, `Server: ...`, `References: ...`ï¼‰ã€‚
- é–¢é€£ã®ãªã„ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¤‰æ›´ã¯é¿ã‘ã‚‹ã€‚
- UI å¤‰æ›´æ™‚ã¯å¿…è¦ã«å¿œã˜ã¦ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ/GIF ã‚’æ·»ä»˜ã€‚
- PR å‰ã« smoke tests ã¨ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ã‚¦ã‚¶ç¢ºèªã‚’å®Ÿæ–½ã€‚

## â¤ï¸ Support / Sponsor
ã‚¹ãƒãƒ³ã‚µãƒ¼/ã‚µãƒãƒ¼ãƒˆãƒªãƒ³ã‚¯ã¯ `.github/FUNDING.yml` ã§è¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚
- GitHub Sponsors: https://github.com/sponsors/lachlanchen
- Lazying.art: https://lazying.art
- Chat: https://chat.lazying.art
- OnlyIdeas: https://onlyideas.art

## ğŸ“š å‚è€ƒè³‡æ–™
- `references/ai-trader-overview.md`
- `references/database_setup_postgres.md`
- `references/mt5_python_setup_ubuntu.md`
- `references/mt4_vs_mt5.md`
- `references/llm_trading_system.md`
- `references/release_deploy.md`
- `references/pnl_debugging.md`

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹
ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã¯ 2026-02-28 æ™‚ç‚¹ã§ `LICENSE` ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚

Assumption: ãƒ©ã‚¤ã‚»ãƒ³ã‚¹æ¡ä»¶ã¯ç¾åœ¨ãƒªãƒã‚¸ãƒˆãƒªå†…ã§æœªæŒ‡å®šã§ã™ã€‚ãƒ¡ãƒ³ãƒ†ãƒŠãƒ¼ãŒæ˜ç¤ºçš„ãªãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã™ã‚‹ã¾ã§ã€ã“ã®æ³¨è¨˜ã‚’ç¶­æŒã—ã¾ã™ã€‚
